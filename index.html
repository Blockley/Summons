<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <link rel="stylesheet" href="style.css">
        <title>Blockley Lodge No.6345 – Summons</title>
        <meta name="robots" content="noindex">
    </head>
    <body>
    <main>
        <img src="logo.svg" class=logo>
        <h1>Blockley&nbsp;Lodge</h1>
        <h4>Of Antient, Free and Accepted Masons, N. 6345,&nbsp;Oxford</h4>
        <h2>W. Bro. Dr Daniel Antonio Villar Maldonado, Worshipful&nbsp;Master</h2>
        <p class="left">Dear Sir and Brother,<br>By command of the Worshipful Master, I hereby summon and invite you to attend the next regular meeting of the Blockley Lodge, to be held at: Cardinal House, OX44 9LT on <strong>Saturday 7 February <!--<span id="meeting-date"></span>--> at&nbsp;noon.</strong><br>
        Yours faithfully and fraternally,<br>
            W. Bro. Matthew Standage ProvGPurs, Secretary (Acting)<br>
            <a href="mailto:secretary@blockleylodge.org.uk">secretary@blockleylodge.org.uk</a>
            <p class="memoriam"><em>In memoriam</em> W. Bro. Robert Harris</p>
        <h3>Agenda</h3>
        <ol>
            <li>Open the Lodge.</li>
            <li>Read the Dispensations.</li>
            <li>Take as read and consider for confirmation the minutes of the last regular meeting.</li>
            <li>Ballot for as joining members those brethren detailed in Annex A.</li>
            <li>Elect a Treasurer for the ensuing year.<br><em>The only nominations of which the Secretary is aware is  W. Bro. Dr Daniel Villar Maldonado, and subject to the provisions of rule 112, it is proposed to declare the ballot in their favour. Any member may, however, demand a&nbsp;ballot.</em></li>
            <li>Install the Master Elect, Bro. Dr Alexander Ross Humphries.</li>
            <li>Appoint and invest Officers of the Lodge.</li>
            <li>Elect a brother to serve with the Worshipful Master on the Provincial Grand Lodge Committee.</li>
            <li>Recieve reports and notices of propositions.</li>
            <li>Close the Lodge.</li>
        </ol>
<p><em>Dress: lounge or morning suit, undress regalia</em></p>

        <p><strong>Dining:</strong> Please use this <a href="https://dining.blockleylodge.org.uk" target="_blank">booking form</a> (deadline Saturday 31 January<!--<span id="booking-deadline"></span>-->)</p>

<p class="psmall">Alms will be collected at dinner via the Lodge <a href="https://gtap.uk/L6345" target="_blank">Relief Chest</a>. Electronic donations are&nbsp;preferred.</p>
    

<p><strong>The Lodge welcomes enquiries for membership and candidates for&nbsp;initation.</strong></p> 

<p class="psmall"><em>“Be very cautious, whom you recommend as a candidate for Membership; one false step on this point may be fatal. If you introduce a disputatious person, confusion will be produced which may end in the dissolution of the Lodge. If you have a good Lodge keep it select. Great numbers are not always&nbsp;beneficial.”</em> –&nbsp;Dr&nbsp;Oliver<p>


<p class="royal-arch">Any Brother who is interested in pursuing Exaltation in the Royal Arch, for which the qualification is to have been a Master Mason for at least four weeks, is invited to contact the Royal Arch&nbsp;Representative.</p>


<p class="footer-links"><a href="https://officers.blockleylodge.org.uk" target="_blank">Lodge Officers</a> | <a href="https://mobile.portal.ugle.org.uk/auth/login" target="_blank">UGLE Portal</a> | <a href="https://links.blockleylodge.org.uk" target="_blank">Useful links</a> | <a href="https://friends.blockleylodge.org.uk" target="_blank">Join our mailing list</a></p>

    </main>
<script>
  function getNextMeetingDate(today = new Date()) {
    // Normalize "today" to midnight so comparisons work correctly
    today.setHours(0, 0, 0, 0);

    const year = today.getFullYear();

    // Meeting rules
    const meetingSpecs = [
      { month: 1,  ordinal: 2 },      // February (2nd Saturday)
      { month: 2,  ordinal: 2 },      // March (2nd Saturday)
      { month: 6,  ordinal: 'last' }, // July (Last Saturday)
      { month: 9,  ordinal: 3 },      // October (3rd Saturday)
      { month: 10, ordinal: 3 }       // November (3rd Saturday)
    ];

    // Finds the Nth (or last) Saturday in a month
    function getNthSaturday(year, month, order) {
      const saturdays = [];
      const date = new Date(year, month, 1);

      while (date.getMonth() === month) {
        if (date.getDay() === 6) {
          // Store midnight-normalized date
          const d = new Date(date);
          d.setHours(0, 0, 0, 0);
          saturdays.push(d);
        }
        date.setDate(date.getDate() + 1);
      }

      return order === "last"
        ? saturdays[saturdays.length - 1]
        : saturdays[order - 1];
    }

    // Collect all meetings this year
    const meetingDates = meetingSpecs
      .map(spec => getNthSaturday(year, spec.month, spec.ordinal))
      .filter(date => date >= today); // NOW includes today properly

    // If none left this year, choose next Feb (2nd Saturday)
    if (meetingDates.length === 0) {
      return getNthSaturday(year + 1, 1, 2);
    }

    // Return earliest meeting (today included if it's meeting day)
    return meetingDates.sort((a, b) => a - b)[0];
  }

  const nextMeeting = getNextMeetingDate();

  // Booking deadline = 7 days before meeting
  const bookingDeadline = new Date(nextMeeting);
  bookingDeadline.setDate(bookingDeadline.getDate() - 7);

  // Options without year
  const options = {
    weekday: 'long',
    month: 'long',
    day: 'numeric'
  };

  document.getElementById("meeting-date").textContent =
    nextMeeting.toLocaleDateString(undefined, options);

  document.getElementById("booking-deadline").textContent =
    bookingDeadline.toLocaleDateString(undefined, options);
</script>        
    </body>
</html>
